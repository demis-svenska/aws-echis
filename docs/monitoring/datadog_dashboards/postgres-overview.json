{"notify_list":[],"description":"An overview of your Postgres metrics (cloned)","template_variables":[{"default":"production","prefix":"environment","name":"env"},{"default":"*","prefix":"host","name":"host"},{"default":"*","prefix":"group","name":"pg_group"}],"is_read_only":false,"id":"unt-6cf-nbs","title":"Postgres - Overview","url":"/dashboard/unt-6cf-nbs/postgres---overview","created_at":"2017-03-20T12:17:06.666237+00:00","modified_at":"2019-07-05T05:58:47.263319+00:00","author_handle":"skelly@dimagi.com","widgets":[{"definition":{"requests":[{"q":"avg:postgresql.rows_fetched{$env,$host,$pg_group} by {host}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"},{"q":"avg:postgresql.rows_returned{$env,$host,$pg_group} by {host}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","title":"Rows fetched / returned (per sec)"},"id":188861316},{"definition":{"requests":[{"q":"avg:postgresql.rows_inserted{$env,$host,$pg_group} by {host}, avg:postgresql.rows_deleted{$env,$host,$pg_group} by {host}, avg:postgresql.rows_updated{$env,$host,$pg_group} by {host}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"title":"Inserts / updates / deletes (per sec) (log)","type":"timeseries","yaxis":{"include_zero":false,"scale":"log"}},"id":188861318},{"definition":{"requests":[{"q":"sum:postgresql.connections{$env,$host,$pg_group} by {db}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","title":"Connections (by DB)"},"id":188861317},{"definition":{"requests":[{"q":"outliers(avg:system.io.util{$env,$host,group:postgresql,$pg_group} by {host}, 'DBSCAN', 1.5), outliers(avg:system.io.util{$env,$host,group:pg_standby,$pg_group} by {host}, 'DBSCAN', 1.5)","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","title":"Disk utilization (%)"},"id":188861319},{"definition":{"requests":[{"q":"avg:system.load.norm.1{$env,$host,group:postgresql,$pg_group} by {host}, avg:system.load.norm.1{$env,$host,group:pg_standby,$pg_group} by {host}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","events":[{"q":"$scope ","tags_execution":"and"}],"markers":[{"display_type":"error dashed","value":"y = 1"}],"title":"System load (normalized)"},"id":188861320},{"definition":{"requests":[{"q":"avg:system.cpu.idle{$env,$host,$pg_group}, avg:system.cpu.system{$env,$host,$pg_group}, avg:system.cpu.iowait{$env,$host,$pg_group}, avg:system.cpu.user{$env,$host,$pg_group}, avg:system.cpu.stolen{$env,$host,$pg_group}, avg:system.cpu.guest{$env,$host,$pg_group}","display_type":"area"}],"type":"timeseries","title":"CPU usage (%)"},"id":188861321},{"definition":{"requests":[{"q":"outliers(max:system.cpu.iowait{$env,$host,group:postgresql,$pg_group} by {host}, 'DBSCAN', 3), outliers(max:system.cpu.iowait{$env,$host,group:pg_standby,$pg_group} by {host}, 'DBSCAN', 3)","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","title":"I/O wait (%)"},"id":188861322},{"definition":{"requests":[{"q":"sum:system.mem.usable{$env,$host,$pg_group}, sum:system.mem.total{$env,$host,$pg_group}-sum:system.mem.usable{$env,$host,$pg_group}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"area","metadata":[{"alias_name":"mem.free","expression":"sum:system.mem.usable{$env,$host,$pg_group}"},{"alias_name":"mem.used","expression":"sum:system.mem.total{$env,$host,$pg_group}-sum:system.mem.usable{$env,$host,$pg_group}"}]}],"type":"timeseries","title":"System memory"},"id":188861323},{"definition":{"requests":[{"q":"avg:system.mem.used{$env,$host,$pg_group,group:postgresql} by {host}, avg:system.swap.used{$env,$host,$pg_group,group:postgresql} by {host}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"area"}],"type":"timeseries","title":"Memory usage (ram,swap)"},"id":4883102234198048},{"definition":{"style":{"palette":"green_to_orange","palette_flip":false},"title":"Nodes","no_metric_hosts":true,"scope":["$env","$host","group:postgresql","$pg_group"],"requests":{"size":{"q":"avg:system.swap.pct_free{$env,$host,group:postgresql,$pg_group} by {host}"},"fill":{"q":"avg:system.load.norm.1{$env,$host,group:postgresql,$pg_group} by {host}"}},"no_group_hosts":true,"type":"hostmap"},"id":403110372},{"definition":{"requests":[{"q":"sum:system.net.bytes_rcvd{$env,$host,$pg_group}, sum:system.net.bytes_sent{$env,$host,$pg_group}","style":{"line_width":"normal","palette":"cool","line_type":"solid"},"display_type":"area"}],"type":"timeseries","title":"Network traffic (kb/s)"},"id":188861324},{"definition":{"requests":[{"q":"avg:postgresql.replication_delay{$env,$host,$pg_group} by {host}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","title":"Replication delay by host"},"id":253462140},{"definition":{"requests":[{"q":"sum:postgresql.connections{$env,$host,$pg_group} by {host}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","title":"Connections by host"},"id":256956002},{"definition":{"requests":[{"q":"sum:pgbouncer.pools.cl_active{$env,$host,$pg_group} by {host}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","events":[{"q":"tags:$env Deploy Success ","tags_execution":"and"}],"title":"Pgbouncer Active connections"},"id":256956003},{"definition":{"requests":[{"q":"max:pgbouncer.stats.avg_query_time{$env,$host,$pg_group} by {db,host}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","title":"Avg query time by DB"},"id":295542364},{"definition":{"requests":[{"q":"max:pgbouncer.stats.total_query_time{$env,$host,$pg_group} by {db,host}, max:pgbouncer.stats.total_transaction_time{$env,$host,$pg_group} by {db,host}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","title":"Total transaction / query time by DB"},"id":295542429},{"definition":{"requests":[{"q":"sum:pgbouncer.stats.transactions_per_second{$env,$host,$pg_group} by {host}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","title":"Pgbouncer transactions per second"},"id":258422206},{"definition":{"requests":[{"q":"avg:pgbouncer.stats.avg_transaction_time{$env,$host,$pg_group} by {db,host}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","title":"Avg transaction time"},"id":306008584},{"definition":{"requests":[{"q":"forecast(avg:system.disk.in_use{$env,$host,device:/opt/data,group:pg_standby,$pg_group} by {host}*100,'linear',1)","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"},{"q":"forecast(avg:system.disk.in_use{$env,$host,device:/opt/data,group:postgresql,$pg_group} by {host}*100,'linear',1)","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","title":"Disk usage by host (%)"},"id":377635046},{"definition":{"requests":[{"q":"avg:postgresql.connections.state{$env,$host,$pg_group} by {state}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"area"}],"type":"timeseries","title":"Connections by state"},"id":391331707},{"definition":{"requests":[{"q":"sum:pgbouncer.pools.cl_waiting{$env,$host,$pg_group} by {host}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","title":"pgbouncer clients waiting"},"id":391332138},{"definition":{"requests":[{"q":"avg:system.disk.used{$env,$host,group:postgresql,device:/opt/data,$pg_group} by {host}, avg:system.disk.used{$env,$host,device:/opt/data,group:pg_standby,$pg_group} by {host}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","title":"Disk used"},"id":400095739},{"definition":{"requests":[{"q":"sum:system.io.r_s{$env,$host,$pg_group,group:postgresql} by {host}, sum:system.io.w_s{$env,$host,$pg_group,group:postgresql} by {host}, sum:system.io.w_s{$env,$host,$pg_group,group:pg_standby} by {host}, sum:system.io.r_s{$env,$host,$pg_group,group:pg_standby} by {host}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","title":"Disk IOPS (all disks)"},"id":4805352332658496},{"definition":{"requests":[{"q":"avg:pgbouncer.stats.avg_query_time{$env,$host,$pg_group}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","title":"Avg of pgbouncer.stats.avg_query_time over $env,$host,$pg_group"},"id":4999414492636626},{"definition":{"requests":[{"q":"avg:pgbouncer_custom.clients.count{environment:icds,host:pgmain0.internal-icds.commcarehq.org} by {client_addr}","style":{"line_width":"normal","palette":"dog_classic","line_type":"solid"},"display_type":"line"}],"type":"timeseries","title":"Avg of pgbouncer_custom.clients.count over $env,$host,$pg_group by client_addr"},"id":2807384574149948}],"layout_type":"ordered"}
